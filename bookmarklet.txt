javascript:%2F* ics.js Wed Aug 20 2014 17%3A23%3A02 *%2Fvar saveAs%3DsaveAs%7C%7Cfunction(a)%7Bif(!("undefined"%3D%3D%3Dtypeof a%7C%7C"undefined"!%3D%3Dtypeof navigator%26%26%2FMSIE %5B1-9%5D%5C.%2F.test(navigator.userAgent)))%7Bvar n%3Da.document.createElementNS("http%3A%2F%2Fwww.w3.org%2F1999%2Fxhtml"%2C"a")%2Cg%3D"download"in n%2Cl%3D%2Fconstructor%2Fi.test(a.HTMLElement)%7C%7Ca.safari%2Cq%3D%2FCriOS%5C%2F%5B%5Cd%5D%2B%2F.test(navigator.userAgent)%2Cw%3Dfunction(c)%7B(a.setImmediate%7C%7Ca.setTimeout)(function()%7Bthrow c%3B%7D%2C0)%7D%2Cr%3Dfunction(c)%7BsetTimeout(function()%7B"string"%3D%3D%3Dtypeof c%3F(a.URL%7C%7Ca.webkitURL%7C%7Ca).revokeObjectURL(c)%3Ac.remove()%7D%2C4E4)%7D%2Cm%3Dfunction(c)%7Breturn%2F%5E%5Cs*(%3F%3Atext%5C%2F%5CS*%7Capplication%5C%2Fxml%7C%5CS*%5C%2F%5CS*%5C%2Bxml)%5Cs*%3B.*charset%5Cs*%3D%5Cs*utf-8%2Fi.test(c.type)%3Fnew Blob(%5BString.fromCharCode(65279)%2Cc%5D%2C%7Btype%3Ac.type%7D)%3Ac%7D%2Cx%3Dfunction(c%2Cp%2Cb)%7Bb%7C%7C(c%3Dm(c))%3Bvar d%3Dthis%2Cv%3D"application%2Foctet-stream"%3D%3D%3Dc.type%2Cu%3Dfunction()%7Bvar h%3D%5B"writestart"%2C"progress"%2C"write"%2C"writeend"%5D%3Bh%3D%5B%5D.concat(h)%3Bfor(var y%3Dh.length%3By--%3B)%7Bvar A%3Dd%5B"on"%2Bh%5By%5D%5D%3Bif("function"%3D%3D%3Dtypeof A)try%7BA.call(d%2Cd)%7Dcatch(B)%7Bw(B)%7D%7D%7D%3Bd.readyState%3Dd.INIT%3Bif(g)%7Bvar k%3D(a.URL%7C%7Ca.webkitURL%7C%7Ca).createObjectURL(c)%3BsetTimeout(function()%7Bn.href%3Dk%3Bn.download%3Dp%3Bvar h%3Dnew MouseEvent("click")%3Bn.dispatchEvent(h)%3Bu()%3Br(k)%3Bd.readyState%3Dd.DONE%7D)%7Delse(function()%7Bif((q%7C%7Cv%26%26l)%26%26a.FileReader)%7Bvar h%3Dnew FileReader%3Bh.onloadend%3Dfunction()%7Bvar y%3Dq%3Fh.result%3Ah.result.replace(%2F%5Edata%3A%5B%5E%3B%5D*%3B%2F%2C"data%3Aattachment%2Ffile%3B")%3Ba.open(y%2C"_blank")%7C%7C(a.location.href%3Dy)%3Bd.readyState%3Dd.DONE%3Bu()%7D%3Bh.readAsDataURL(c)%3Bd.readyState%3Dd.INIT%7Delse k%7C%7C(k%3D(a.URL%7C%7Ca.webkitURL%7C%7Ca).createObjectURL(c))%2Cv%3Fa.location.href%3Dk%3Aa.open(k%2C"_blank")%7C%7C(a.location.href%3Dk)%2Cd.readyState%3Dd.DONE%2Cu()%2Cr(k)%7D)()%7D%2Ce%3Dx.prototype%3Bif("undefined"!%3D%3Dtypeof navigator%26%26navigator.msSaveOrOpenBlob)return function(c%2Cp%2Cb)%7Bp%3Dp%7C%7Cc.name%7C%7C"download"%3Bb%7C%7C(c%3Dm(c))%3Breturn navigator.msSaveOrOpenBlob(c%2Cp)%7D%3Be.abort%3Dfunction()%7B%7D%3Be.readyState%3De.INIT%3D0%3Be.WRITING%3D1%3Be.DONE%3D2%3Be.error%3De.onwritestart%3De.onprogress%3De.onwrite%3De.onabort%3De.onerror%3De.onwriteend%3Dnull%3Breturn function(c%2Cp%2Cb)%7Breturn new x(c%2Cp%7C%7Cc.name%7C%7C"download"%2Cb)%7D%7D%7D("undefined"!%3D%3Dtypeof self%26%26self%7C%7C"undefined"!%3D%3Dtypeof window%26%26window%7C%7Cthis.content)%3B"undefined"!%3D%3Dtypeof module%26%26module.exports%3Fmodule.exports.saveAs%3DsaveAs%3A"undefined"!%3D%3Dtypeof define%26%26null!%3D%3Ddefine%26%26null!%3D%3Ddefine.amd%26%26define("FileSaver.js"%2Cfunction()%7Breturn saveAs%7D)%3Bvar ics%3Dfunction(a%2Cn)%7Bif(!(-1<navigator.userAgent.indexOf("MSIE")%26%26-1%3D%3Dnavigator.userAgent.indexOf("MSIE 10")))%7Bvoid 0%3D%3D%3Da%26%26(a%3D"default")%3Bvoid 0%3D%3D%3Dn%26%26(n%3D"Calendar")%3Bvar g%3D-1!%3D%3Dnavigator.appVersion.indexOf("Win")%3F"%5Cr%5Cn"%3A"%5Cn"%2Cl%3D%5B%5D%2Cq%3D%5B"BEGIN%3AVCALENDAR"%2C"PRODID%3A"%2Bn%2C"VERSION%3A2.0"%5D.join(g)%2Cw%3Dg%2B"END%3AVCALENDAR"%2Cr%3D"SU MO TU WE TH FR SA".split(" ")%3Breturn%7Bevents%3Afunction()%7Breturn l%7D%2Ccalendar%3Afunction()%7Breturn q%2Bg%2Bl.join(g)%2Bw%7D%2CaddEvent%3Afunction(m%2Cx%2Ce%2Cc%2Cp%2Cb)%7Bif(void 0%3D%3D%3Dm%7C%7Cvoid 0%3D%3D%3Dx%7C%7Cvoid 0%3D%3D%3De%7C%7Cvoid 0%3D%3D%3Dc%7C%7Cvoid 0%3D%3D%3Dp)return!1%3Bif(b%26%26!b.rrule)%7Bif("YEARLY"!%3D%3Db.freq%26%26"MONTHLY"!%3D%3Db.freq%26%26"WEEKLY"!%3D%3Db.freq%26%26"DAILY"!%3D%3Db.freq)throw"Recurrence rrule frequency must be provided and be one of the following%3A 'YEARLY'%2C 'MONTHLY'%2C 'WEEKLY'%2C or 'DAILY'"%3Bif(b.until%26%26isNaN(Date.parse(b.until)))throw"Recurrence rrule 'until' must be a valid date string"%3Bif(b.interval%26%26isNaN(parseInt(b.interval)))throw"Recurrence rrule 'interval' must be an integer"%3Bif(b.count%26%26isNaN(parseInt(b.count)))throw"Recurrence rrule 'count' must be an integer"%3Bif(void 0!%3D%3Db.byday)%7Bif("%5Bobject Array%5D"!%3D%3DObject.prototype.toString.call(b.byday))throw"Recurrence rrule 'byday' must be an array"%3Bif(7<b.byday.length)throw"Recurrence rrule 'byday' array must not be longer than the 7 days in a week"%3Bb.byday%3Db.byday.filter(function(H%2CI)%7Breturn b.byday.indexOf(H)%3D%3DI%7D)%3Bfor(var d in b.byday)if(0>r.indexOf(b.byday%5Bd%5D))throw"Recurrence rrule 'byday' values must include only the following%3A 'SU'%2C 'MO'%2C 'TU'%2C 'WE'%2C 'TH'%2C 'FR'%2C 'SA'"%3B%7D%7Dvar v%3Dnew Date(c)%2Cu%3Dnew Date(p)%2Ck%3Dnew Date%3Bp%3D("0000"%2Bv.getFullYear().toString()).slice(-4)%3Bc%3D("00"%2B(v.getMonth()%2B1).toString()).slice(-2)%3Bd%3D("00"%2Bv.getDate().toString()).slice(-2)%3Bvar h%3D("00"%2Bv.getHours().toString()).slice(-2)%2Cy%3D("00"%2Bv.getMinutes().toString()).slice(-2)%2CA%3D("00"%2Bv.getSeconds().toString()).slice(-2)%3Bv%3D("0000"%2Bu.getFullYear().toString()).slice(-4)%3Bvar B%3D("00"%2B(u.getMonth()%2B1).toString()).slice(-2)%2CJ%3D("00"%2Bu.getDate().toString()).slice(-2)%2CC%3D("00"%2Bu.getHours().toString()).slice(-2)%2CD%3D("00"%2Bu.getMinutes().toString()).slice(-2)%2CE%3D("00"%2Bu.getMinutes().toString()).slice(-2)%3Bu%3D("0000"%2Bk.getFullYear().toString()).slice(-4)%3Bvar K%3D("00"%2B(k.getMonth()%2B1).toString()).slice(-2)%2CL%3D("00"%2Bk.getDate().toString()).slice(-2)%2CM%3D("00"%2Bk.getHours().toString()).slice(-2)%2CN%3D("00"%2Bk.getMinutes().toString()).slice(-2)%3Bk%3D("00"%2Bk.getMinutes().toString()).slice(-2)%3Bvar F%3D""%2CG%3D""%3B0!%3Dh%2By%2BA%2BC%2BD%2BE%26%26(F%3D"T"%2Bh%2By%2BA%2CG%3D"T"%2BC%2BD%2BE)%3Bp%3Dp%2Bc%2Bd%2BF%3Bc%3Dv%2BB%2BJ%2BG%3Bd%3Du%2BK%2BL%2B("T"%2BM%2BN%2Bk)%3Bif(b)if(b.rrule)var z%3Db.rrule%3Belse%7Bif(z%3D"rrule%3AFREQ%3D"%2Bb.freq%2Cb.until)h%3D(new Date(Date.parse(b.until))).toISOString()%2Cz%2B%3D"%3BUNTIL%3D"%2Bh.substring(0%2Ch.length-13).replace(%2F%5B-%5D%2Fg%2C"")%2B"000000Z"%3Bb.interval%26%26(z%2B%3D"%3BINTERVAL%3D"%2Bb.interval)%3Bb.count%26%26(z%2B%3D"%3BCOUNT%3D"%2Bb.count)%3Bb.byday%26%260<b.byday.length%26%26(z%2B%3D"%3BBYDAY%3D"%2Bb.byday.join("%2C"))%7D(new Date).toISOString()%3Bm%3D%5B"BEGIN%3AVEVENT"%2C"UID%3A"%2Bl.length%2B"%40"%2Ba%2C"CLASS%3APUBLIC"%2C"DESCRIPTION%3A"%2Bx%2C"DTSTAMP%3BVALUE%3DDATE-TIME%3A"%2Bd%2C"DTSTART%3BVALUE%3DDATE-TIME%3A"%2Bp%2C"DTEND%3BVALUE%3DDATE-TIME%3A"%2Bc%2C"LOCATION%3A"%2Be%2C"SUMMARY%3BLANGUAGE%3Den-us%3A"%2Bm%2C"TRANSP%3ATRANSPARENT"%2C"END%3AVEVENT"%5D%3Breturn z%26%26m.splice(4%2C0%2Cz)%2Cm%3Dm.join(g)%2Cl.push(m)%2Cm%7D%2Cdownload%3Afunction(m%2Cx)%7Bif(1>l.length)return!1%3Bx%3Dvoid 0!%3D%3Dx%3Fx%3A".ics"%3Bm%3Dvoid 0!%3D%3Dm%3Fm%3A"calendar"%3Bvar e%3Dq%2Bg%2Bl.join(g)%2Bw%3Bif(-1%3D%3D%3Dnavigator.userAgent.indexOf("MSIE 10"))var c%3Dnew Blob(%5Be%5D)%3Belse c%3Dnew BlobBuilder%2Cc.append(e)%2Cc%3Dc.getBlob("text%2Fx-vCalendar%3Bcharset%3D"%2Bdocument.characterSet)%3Breturn saveAs(c%2Cm%2Bx)%2Ce%7D%2Cbuild%3Afunction()%7Breturn!(1>l.length)%26%26q%2Bg%2Bl.join(g)%2Bw%7D%7D%7Dconsole.log("Unsupported Browser")%7D%2Cf%3Ddocument.querySelector("%23ptifrmtgtframe").contentWindow.document%2Ct%3Df.querySelector("%23ACE_width")%2Cmonth%3Df.querySelector("%23DERIVED_SCH_CAL_MONTH_XLAT").value%2Ctds%3Dt.querySelectorAll("td%3Afirst-child")%2CcurrentYear%3D(new Date).getFullYear()%2Ccal%3Dics()%3Btds.forEach(function(a)%7Ba%3Da.innerText.trim()%3Bif(%2F%5E%5Cd%2B%5Cn%2F.test(a)%26%26!%2F%5CbOFF%5Cb%2F.test(a))%7Bvar n%3Da.split("%5Cn")%3Bn.splice(1%2C5)%3Ba%3Dn%5B1%5D.split("-")%3Ba%5B1%5D%3Da%5B1%5D.substring(1)%3Bvar g%3Da%5B0%5D.split("%3A")%2Cl%3Da%5B1%5D.split("%3A")%2Cq%3Dg%5B1%5D.slice(-2)%3Ba%3DparseInt(g%5B0%5D)%3Bg%3DparseInt(g%5B1%5D)%3B12!%3D%3Da%26%26"PM"%3D%3Dq%26%26(a%2B%3D12)%3Bvar w%3Dl%5B1%5D.slice(-2)%3Bq%3DparseInt(l%5B0%5D)%3Bl%3DparseInt(l%5B1%5D)%3B12!%3D%3Dq%26%26"PM"%3D%3Dw%26%26(q%2B%3D12)%3Bw%3DparseInt(month)-1%3Bn%3DparseInt(n%5B0%5D)%3Bvar r%3Dnew Date%3Br.setYear(currentYear)%3Br.setMonth(w)%3Br.setDate(n)%3Br.setHours(a%2B4)%3Br.setMinutes(g)%3Br.setSeconds(0)%3Ba%3Dnew Date%3Ba.setYear(currentYear)%3Ba.setMonth(w)%3Ba.setDate(n)%3Ba.setHours(q%2B4)%3Ba.setMinutes(l)%3Ba.setSeconds(0)%3Bcal.addEvent("Work"%2C""%2C""%2Cr%2Ca)%7D%7D)%3Bcal.download("WorkSchedule"%2Bmonth%2B"%2F"%2BcurrentYear)%3Bvoid+0